var hive_loader = require('hive-loader');
var layout_file_handler = require('handlers/layout_file_handler');
var layout_config_handler = require('handlers/layout_config_handler');
var _DEBUG = false;
var hive_mvc = require('hive-mvc');

module.exports = function(layout){
	if (_DEBUG) console.log('loading layout at %s', layout.get_config('root'));
	var resources_handler = hive_mvc.handlers.resources;
	var loader = hive_loader.loader({}, {
		handlers: [layout_file_handler(), layout_config_handler(), resources_handler()],
		root: layout.get_config('root'),
		target: layout
	});

	loader.core(layout.get_config('apiary'));

	return loader;
};